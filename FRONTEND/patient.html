<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
       body {
  font-family: Arial, sans-serif;
  background-color: #f2f4f7;
  margin: 0;
  padding: 0;
}

.wrapper_three {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

/* Top Buttons */
.wrapper_three > button {
  margin: 5px;
  padding: 10px 15px;
  border: none;
  background-color: #2c3e50;
  color: #fff;
  font-size: 14px;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.wrapper_three > button:hover {
  background-color: #34495e;
}

/* Forms */
form {
  display: flex;
  flex-direction: column;
  gap: 10px;
  background-color: #fff;
  padding: 15px;
  margin-top: 15px;
  border-radius: 6px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

form label {
  font-weight: bold;
}

form input,
form select {
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 4px;
}

form button {
  padding: 10px;
  background-color: #2980b9;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: bold;
}

form button:hover {
  background-color: #3498db;
}

/* Show all doctors container */
.showAllDoctors,
.specialized_main,
.show_patient_Appointment {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  margin-top: 15px;
}

.showAllDoctors > div,
.specialized_main > .doctor_card {
  background-color: #fff;
  padding: 15px;
  border-radius: 6px;
  width: 200px;
  text-align: center;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  transition: transform 0.2s ease;
}

.showAllDoctors > div:hover,
.specialized_main > .doctor_card:hover {
  transform: translateY(-3px);
}

.showAllDoctors img,
.specialized_main img {
  width: 100%;
  height: auto;
  border-radius: 4px;
}

.doctor_card button {
  margin-top: 10px;
  background-color: #27ae60;
}

.doctor_card button:hover {
  background-color: #2ecc71;
}

/* Appointment info display */
.show_patient_Appointment > div {
  background-color: #fff;
  padding: 10px;
  margin: 5px;
  border-radius: 4px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  width: 100%;
}

/* Hide elements with .active */
.active {
  display: none;
}

/* Prescription Card Styles */
.card_container {
  background-color: #fff;
  padding: 15px;
  border-radius: 6px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  margin-top: 15px;
  max-width: 500px;
}

.patient_name {
  font-weight: bold;
  font-size: 16px;
  margin-bottom: 5px;
}

.issue_date {
  font-size: 14px;
  color: #555;
  margin-bottom: 5px;
}

.medi {
  font-size: 14px;
  margin-bottom: 5px;
}

.note {
  font-style: italic;
  color: #333;
}

.showPrescription {
  margin-top: 20px;
}

      </style>
      
      
</head>
<body>
    <div class="wrapper_three">
             

               <button class="speacialized-btn">Specialization</button>
                <button class="yourAppointment_btn">Your-Appointment</button>
                <button class="main_page">Back</button>
                <button class="logOut">Log-out</button>
                <button class="fillForm">Patient Form</button>
                 <button class="prescription_btn">See Prescription</button>
              <!-- sabhi doctors ko dikhao -->
               <div class="showAllDoctors">
                      
               </div>
               
               <div class="specialized_container">
                         <form class="specialized_form">
                            <label for="specialization">Specialization</label>
                            <select name="Specialization" id="specialization">
                                <option value="">--Select--</option>
                                <option value="General Physician">General Physician</option>
                                <option value="Cardiologist">Cardiologist</option>
                                <option value="Neurologist">Neurologist</option>
                                <option value="Dermatologist">Dermatologist</option>
                                <option value="Pediatrician">Pediatrician</option>
                                <option value="Gynecologist">Gynecologist</option>
                                <option value="Orthopedic">Orthopedic</option>
                                <option value="Dentist">Dentist</option>
                                <option value="Psychiatrist">Psychiatrist</option>
                                <option value="ENT Specialist">ENT Specialist</option>
                              
                            </select>
                               <button id="submit-btn">Submit</button>
                        </form>
               </div>

               <div class="specialized_main">
                          
               </div>
               

               <div class="appointment_container">

                  <form id="appointment_form">
                         <label for="appointment_date">Appointment Date</label>
                        <input type="date" id="appointment_date">
                        <button id="appointment_btn">Book</button>
                        </form>
               </div>

               <div class="show_patient_Appointment">
                        
               </div>

              
               
            <div class="createPatient_Container">
                        <form class="patient_form">
                               
                               <label for="patient_age">Age:</label>

                               <input type="text" placeholder="enter your age" id="patient_age">
                               <label for="gender">Gender :</label>
                               <select name="gender" id="gender">
                                   <option value="">--Select</option>
                                   <option value="Male">Male</option>
                                   <option value="Female">Female</option>
                                   <option value="Others">Others</option>
                               </select>
                               <label for="patient_phone">Phone Number :</label>
                               <input type="text" placeholder="enter your phone number" id="patient_phone">
                               <label for="patient_adhar">Adhar Number :</label>
                               <input type="text" placeholder="enter your adhar" id="patient_adhar">

                               <button id="submit_patient">Submit</button>
                        </form>
            </div>

             
                  <div class="readPrescription">
                               <form class="get_prescription">
                                    <label for="get_adhar">Enter Adhar Number</label>
                                    <input type="text" placeholder="enter adhar number" id="get_adhar">
                                       <button id="get_btn">submit</button>
                               </form> 
                  </div>

                  <div class="showPrescription">

                  </div>

    </div>
    <script>
            document.addEventListener("DOMContentLoaded",async()=>{
                   
                let speacializedBtn = document.querySelector(".speacialized-btn");
                let showAllDoctors = document.querySelector(".showAllDoctors");
                let specializedContainer = document.querySelector(".specialized_container");
                let specializedForm = document.querySelector(".specialized_form");
                let specializedMain = document.querySelector(".specialized_main");
                  let appointmentContainer = document.querySelector(".appointment_container");
                  let appointmentForm = document.querySelector("#appointment_form");
                  let backBtn = document.querySelector(".main_page");
                  let logOutBtn = document.querySelector(".logOut");
                  let yourAppointmentBtn = document.querySelector(".yourAppointment_btn");
                 
                  let parent_appointment_card = document.querySelector(".show_patient_Appointment");
                  //********************************************************************
                 
                   document.querySelector(".speacialized-btn").classList.add("active");
                  let patientform = document.querySelector(".patient_form");
                  let formbtn = document.querySelector(".fillForm");
                  document.querySelector(".createPatient_Container").classList.add("active");
                
                  //**********************************************************************
                 specializedContainer.classList.add("active");
                 specializedMain.classList.add("active");
                 appointmentContainer.classList.add("active");
                   backBtn.classList.add("active");
                 parent_appointment_card.classList.add("active");
                 
                 let readform = document.querySelector(".get_prescription");
                 let showPrescription = document.querySelector(".showPrescription");
                 let readPrescription = document.querySelector(".readPrescription");
                      showPrescription.classList.add("active");
                      readPrescription.classList.add("active");
                  
                  
               
                       //loIn se token le liya------------>

                  const token = window.localStorage.getItem("token"); 

                async function AllDoctor(){
                          try{
                    let response = await fetch("http://localhost:4000/api/v1/getAll",{
                        method:"GET",
                        headers:{
                            "Authorization":`Bearer ${token}`,
                            "Content-Type":"application/json"
                        },
                        
                    });

                    let result =await response.json();

                        if(result.success){
                            
                           getAllDoctors=[...result.Doctors];
                          
                        }else{
                            alert(result.message);
                        }
                    }catch(err){
                        console.error(err);
                    }

                }    

                      await  AllDoctor();



                        let ShowAll = document.querySelector(".showAllDoctors");
                        ShowAll.innerHTML="";
                    getAllDoctors.forEach((doctor)=>{
                       
                       let card = document.createElement("div");
                       let imageTag = document.createElement("img");
                 imageTag.setAttribute("src", "./assites/ChatGPT Image Jul 2, 2025, 11_38_00 AM.png");
                          imageTag.setAttribute("alt", "Doctor Image");

                       
                        let head = document.createElement("p");
                            head.innerHTML =`${doctor?.name}`
                            card.appendChild(imageTag);
                                card.appendChild(head);
                              ShowAll.appendChild(card);
                    });
                       

                    

                 speacializedBtn.addEventListener("click",(e)=>{
                     e.preventDefault();

                       //all doctor wala form hide krna hai aur specialization wala show krna hai
                       document.querySelector(".main_page").classList.remove("active");
                       document.querySelector(".specialized_container").classList.remove("active");
                       document.querySelector(".speacialized-btn").classList.add("active");
                        document.querySelector(".showAllDoctors").classList.add("active");
                        document.querySelector(".specialized_main").classList.add("active");
                        document.querySelector(".logOut").classList.add("active");
                        document.querySelector(".createPatient_Container").classList.add("active");
                        document.querySelector(".fillForm").classList.add("active");
                 });


                   let storeSpecializedDoctors = {};

                  async function getsepecializedDoctor(data){
                       try{
                            let token = window.localStorage.getItem("token");
                             let response =await fetch("http://localhost:4000/api/v1/get_specialization",{
                                method:"POST",
                                headers:{
                                    "Content-Type":"application/json",
                                    "Authorization":`Bearer ${token}`
                                },
                               body:JSON.stringify(data)
                             });

                             let result = await response.json();

                             if(result.success){
                                alert(result.message);
                                  storeSpecializedDoctors={...result};
                                   showDoctor(storeSpecializedDoctors);
                                   document.querySelector(".specialized_container").classList.add("active");
                                   document.querySelector(".specialized_main").classList.remove("active");
                             }else{
                                alert(result.message);
                                
                             }

                       }catch(err){
                               console.error(err);
                       }
               }

                            

                  specializedForm.addEventListener("submit",(e)=>{
                    e.preventDefault();

                    let specialization = document.getElementById("specialization").value;
                        
                    let data ={specialization}
                          getsepecializedDoctor(data);
                });





               
               let docId ="";
             function showDoctor(storeSpecializedDoctors){
                 
                let parentElement = document.querySelector(".specialized_main");
                        parentElement.innerHTML="";
                       
                storeSpecializedDoctors.doctor.forEach((doctor)=>{
                   //ek card me ek doctor show ho 
                      
                   let card = document.createElement("div");
                    card.classList.add("doctor_card");
                    let docName = document.createElement("div");
                    let specializedIn = document.createElement("p");
                    let newElement = document.createElement("div");
                    let startTime = document.createElement("div");
                    let endTime = document.createElement("div");
                    let bookBtn = document.createElement("button");

                      docName.setAttribute("id","doctor_name");
                     specializedIn .setAttribute("id","specialized_in");
                     newElement.setAttribute("id","available_days");
                     startTime.setAttribute("id","start_time");
                     endTime.setAttribute("id","end_time");
                     bookBtn.setAttribute("id","book_btn");
                      docName.innerHTML =doctor?.doctorId?.name;
                      specializedIn.innerHTML= doctor?.specialization;
                     newElement.innerHTML = doctor?.available?.days;
                     startTime.innerHTML = doctor?.available?.start ;
                     endTime.innerHTML = doctor?.available?.end;
                     bookBtn.setAttribute("doctor_Id",doctor?._id);
                     bookBtn.innerHTML="Book-Apointment";
                     

                     
                      card.appendChild(docName);
                      card.appendChild(specializedIn);
                      card.appendChild(newElement);
                      card.appendChild(startTime);
                      card.appendChild(endTime);
                       card.appendChild(bookBtn);
                      parentElement.appendChild(card);
                      bookBtn.addEventListener("click",(e)=>{
                           e.preventDefault();
                             docId = bookBtn.getAttribute("doctor_Id");
                       
                         document.querySelector(".appointment_container").classList.remove("active");
                         specializedMain.classList.add("active");
                     })
                })
       
                };






                //complete appointment booking


                async function bookAppointment(data,docId){
                    try{

                    

                    let response = await fetch(`http://localhost:4000/api/v1/book-appointment/${docId}`,{
                        method:"POST",
                        headers:{
                            "Content-Type":"application/json",
                            "Authorization":`Bearer ${token}`
                        },
                        body:JSON.stringify(data)
                    })

                    let result = await response.json();
                    console.log(result);
                   if(result.success){
                       alert(result.message);

                       
                   }else{
                    alert(result.message);
                   }}catch(err){
                    console.error(err);
                   }

                }

              appointmentForm.addEventListener("submit",(e)=>{
                e.preventDefault();
                       let appointmentDate =   document.getElementById("appointment_date").value;
                            
                       let data ={appointmentDate};
                             
                      bookAppointment(data,docId);
              });



          //see your appointment ------------------>


           
                   parent_appointment_card.innerHTML="";
         function showAppoint(data){
                   
              let patientName=   document.createElement("div");
              let status = document.createElement("div");
              let appointmentDate = document.createElement("div");
              let doctorName = document.createElement("div");
               let docttime = document.createElement("div");
              let doctStartTime = document.createElement("span");
              
              let doctEndTime = document.createElement("span");
                  docttime.append(doctStartTime,doctEndTime);
              let docSpecialized = document.createElement("div");

              patientName.setAttribute("id","patient_name");
              status.setAttribute("id","patient_appointment_status");
              appointmentDate.setAttribute("id","patient_appointment_date");
              doctorName.setAttribute("id","patient_appointment_doctor_name");
              docttime.setAttribute("id","appointment_time");
              docSpecialized.setAttribute("id","appointment_doctor_specialized");

              patientName.innerHTML="Name :"+data?.patientName;
              status.innerHTML ="Booking Status :" + data?.status;
              appointmentDate.innerHTML="Appointment Date:" +data?.appointmentDate;
              doctorName.innerHTML= "Doctor Name :" +data?.doctorName;
              doctStartTime.innerHTML="Start : "+ data?.doctStartTime;
              doctEndTime.innerHTML = "End :" +data?.doctEndTime;
              docSpecialized.innerHTML ="Specialized :"+ data?.docSpecialized;


              parent_appointment_card.append(patientName,status,appointmentDate,doctorName,docttime,docSpecialized);
             
            
         }

         async function showAppointment(){
               try{
                  let response = await fetch("http://localhost:4000/api/v1/getyourAppointment",{
                    method:"GET",
                    headers:{
                        "Authorization":`Bearer ${token}`,
                        "Content-Type":"application/json"
                    }
                  });

                  let result =await response.json();
                  if(result.success){
                        
                            let date = result?.Your_Appointment?.appointmentDate;
                               let newDate = new Date(date).toLocaleDateString();
                        let doctStartTime =  result?.Your_Appointment?.doctorId?.available?.start;
                        let doctEndTime =  result?.Your_Appointment?.doctorId?.available?.end;
                        let status = result?.Your_Appointment?.status;
                        let patientName = result?.Your_Appointment?.userId?.name;
                        let docSpecialized = result?.Your_Appointment?.doctorId?.specialization;
                        let doctorName = result?.Your_Appointment?.doctorId?.doctorId?.name;
                       let appointmentDate =newDate
                        let data ={appointmentDate,doctStartTime,doctEndTime,status,patientName,docSpecialized,doctorName};
                              console.log(data);
                             showAppoint(data);
                        
                      


                  }else{
                      alert(result.message);
                  }
               }catch(err){
                console.error(err);
               }
         }



              yourAppointmentBtn.addEventListener("click",(e)=>{
                e.preventDefault();
                 document.querySelector(".speacialized-btn").classList.add("active");
                 document.querySelector(".showAllDoctors").classList.add("active");
                 document.querySelector(".yourAppointment_btn").classList.add("active");
                 document.querySelector(".specialized_container").classList.add("active");
                 document.querySelector(".specialized_main").classList.add("active");
                 document.querySelector(".appointment_container").classList.add("active");
                 document.querySelector(".show_patient_Appointment").classList.remove("active");
                 document.querySelector(".logOut").classList.remove("active");
                 document.querySelector(".main_page").classList.remove("active");
                 document.querySelector(".createPatient_Container").classList.add("active");
                document.querySelector(".fillForm").classList.add("active");
                      showAppointment();
              })

              backBtn.addEventListener("click",(e)=>{
               e. preventDefault();
                 window.location.reload();
              })
                
              logOutBtn.addEventListener("click",(e)=>{
                e.preventDefault();

                window.localStorage.removeItem("token");
                window.location.href ="./index.html";
              })
                      

              async function sendreadForm(data){
                   try{
                let response = fetch("",{
                       method:"POST",
                       headers:{
                          "Authorization":`Bearer ${token}`,
                          "Content-Type":"application/json"
                       },
                       body:JSON.stringify(data)
                });

                let result = response.json();
                    console.log(result);

            }catch(err){
                    console.log(err);
            }
               }



                     





               async function sendCreatePatient(data){
                      try{
                             let response =await fetch("http://localhost:4000/api/v1/patient",{
                                method:"POST",
                                headers:{
                                    "Authorization":`Bearer ${token}`,
                                    "Content-Type":"application/json"
                                },
                                body:JSON.stringify(data)
                             });

                             let result  = await response.json();
                             if(result.success){
                                alert(result.message);
                                document.querySelector(".speacialized-btn").classList.remove("active");
                             }else{
                                alert(result.message);
                             }
                      }catch(err){
                        console.error(err);
                      }
               }



                patientform.addEventListener("submit",(e)=>{
                    e.preventDefault();

                   
                    let newage = document.getElementById("patient_age").value.trim();
                       let age = parseInt(newage);
                     let gender = document.getElementById("gender").value.trim();
                     let phNumber = document.getElementById("patient_phone").value.trim();
                          let phoneNumber = parseInt(phNumber);
                     let adnumber = document.getElementById("patient_adhar").value.trim();
                     let adharNumber = parseInt(adnumber);  

                     if(isNaN(age) || isNaN(phoneNumber) || isNaN(adharNumber)){
                        alert("Enter the value Integer of age ,phone ,adharNumber");
                         return;
                     };

                     if(age < 10 || age > 80){
                        console.log(age);
                        alert("Age Must be greater then 10 and less the 80");
                        return;
                     };
                     if(phNumber.length !== 10){
                        alert("Phone Number must be 10 digits");
                        return;
                     };

                     if(adnumber.length !== 12){
                        alert("Adhar Number must be 12 digits");
                        return;
                     }

                     let data  = {age,gender,phoneNumber,adharNumber};

                     sendCreatePatient(data);
                })

                formbtn.addEventListener("click",(e)=>{
                    e.preventDefault();

                    document.querySelector(".createPatient_Container").classList.remove("active");
                    document.querySelector(".showAllDoctors").classList.add("active");
                    document.querySelector(".fillForm").classList.add("active");

                })
             
                let seeprescriptionBtn = document.querySelector(".prescription_btn");
                  seeprescriptionBtn.addEventListener("click",(e)=>{
                        e.preventDefault();
                        showPrescription.classList.add("active");
                      readPrescription.classList.remove("active");
                      document.querySelector(".showAllDoctors").classList.add("active");
                  })

          async function sendreadForm(data){
                   try{
                let response = await fetch("http://localhost:4000/api/v1/get_prescription",{
                       method:"POST",
                       headers:{
                          "Authorization":`Bearer ${token}`,
                          "Content-Type":"application/json"
                       },
                       body:JSON.stringify(data)
                });

                let result = await response.json();
                    if(result.success){
                         alert(result.message);
                        
                         let data =result?.prescription;
                        
                        showPrescription.classList.remove("active");
                      readPrescription.classList.add("active");
                        
                         showPatientPrescription(data);
                     
                    }else{
                        alert(result.message);
                    }

            }catch(err){
                    console.log(err);
            }
               }

                  
                
                      readform.addEventListener("submit",(e)=>{
                        e.preventDefault();
                          let value = document.getElementById("get_adhar").value.trim();
                         
                          let adharNumber = parseInt(value);

                          let data ={adharNumber};
                            
                          sendreadForm(data)
                            
                      })
                        
                     

                    
                         
                 function    showPatientPrescription(data){
                        showPrescription.innerHTML=""  ; 
                        
                        let card = document.createElement("div");
                           card.className="card_container";
                           let name = document.createElement("div");
                              name.className="patient_name";
                            let date = document.createElement("div");
                              date.className="issue_date";
                            let medicines = document.createElement("div");
                              medicines.className="medi";
                            let notes = document.createElement("div");
                                notes.className="note";
                              let med =  data?.medicines.toString();
                                name.innerHTML="Patient Name :" + data?.userId?.name;
                                medicines.innerHTML ="Medicines :" + med;
                                let newDate = new Date(data?.date_issue).toLocaleDateString()
                                date.innerHTML ="Date_Issue ON:" + newDate ;
                                notes.innerHTML ="Notes :" + data?.notes;

                                card.append(name,date,med,notes);

                                showPrescription.appendChild(card);
                 }

                

               
            })
    </script>
    </body>
   
           
 
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
  <style>
    /* Body and Wrapper */
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f5f7fa;
        margin: 0;
        padding: 20px;
        color: #333;
    }

    .wrapper_three {
        max-width: 1200px;
        margin: 0 auto;
        position: relative;
        padding: 20px;
    }

    /* Specialization Button - Top Right Corner */
    .speacialized-btn {
        background-color: #4a6bff;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 30px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        position: absolute;
        top: 20px;
        right: 20px;
    }

    .speacialized-btn:hover {
        background-color: #3a56d4;
        transform: translateY(-2px);
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    /* All Doctors Grid - 4 in a row, centered */
    .showAllDoctors {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin: 80px auto 40px;
        max-width: 1000px;
        justify-content: center;
    }

    .showAllDoctors p {
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        font-weight: 500;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        transition: transform 0.3s ease;
        border: 1px solid #e1e5eb;
    }

    .showAllDoctors p:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    /* Specialization Form - Centered */
    .specialized_form {
        background-color: white;
        padding: 30px;
        border-radius: 12px;
        width: 400px;
        margin: 40px auto;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        border: 1px solid #e1e5eb;
    }

    .specialized_form label {
        display: block;
        margin-bottom: 12px;
        font-weight: 600;
        color: #444;
        font-size: 16px;
    }

    .specialized_form select {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        margin-bottom: 20px;
        font-size: 15px;
        background-color: #f9fafc;
        transition: border 0.3s ease;
    }

    .specialized_form select:focus {
        border-color: #4a6bff;
        outline: none;
    }

    .specialized_form button {
        background-color: #4a6bff;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 500;
        width: 100%;
        transition: all 0.3s ease;
    }

    .specialized_form button:hover {
        background-color: #3a56d4;
        transform: translateY(-2px);
    }

    /* Specialized Doctors Grid - 4 in a row, centered */
    .specialized_main {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 25px;
        margin: 40px auto;
        max-width: 1100px;
        justify-content: center;
    }

    /* Doctor Card */
    .doctor_card {
        background-color: white;
        border: 1px solid #e1e5eb;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }

    .doctor_card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    /* Doctor Card Elements */
    .doctor_card #doctor_name {
        font-weight: 700;
        font-size: 18px;
        margin-bottom: 10px;
        color: #222;
    }

    .doctor_card #specialized_in {
        font-weight: 500;
        color: #4a6bff;
        margin-bottom: 12px;
        font-size: 15px;
    }

    .doctor_card #available_days {
        font-size: 14px;
        color: #555;
        margin-bottom: 8px;
        background-color: #f5f7fa;
        padding: 6px 10px;
        border-radius: 6px;
        display: inline-block;
    }

    .doctor_card #start_time,
    .doctor_card #end_time {
        font-size: 14px;
        color: #666;
        margin-bottom: 4px;
    }

    /* Book Appointment Button */
    .doctor_card #book_btn {
        background-color: #4a6bff;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 15px;
        font-weight: 500;
        transition: all 0.3s ease;
        align-self: center;
        width: 100%;
    }

    .doctor_card #book_btn:hover {
        background-color: #3a56d4;
        transform: translateY(-2px);
    }

    /* Active/Hidden State */
    .active {
        display: none;
    }

    /* Responsive Adjustments */
    @media (max-width: 1024px) {
        .showAllDoctors,
        .specialized_main {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    @media (max-width: 768px) {
        .showAllDoctors,
        .specialized_main {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .specialized_form {
            width: 90%;
            max-width: 400px;
        }
    }

    @media (max-width: 480px) {
        .showAllDoctors,
        .specialized_main {
            grid-template-columns: 1fr;
        }
        
        .speacialized-btn {
            position: static;
            margin-bottom: 20px;
            width: 100%;
        }
    }
</style>
</head>
<body>
    <div class="wrapper_three">
             

               <button class="speacialized-btn">Specialization</button>
                <button class="yourAppointment_btn">Your-Appointment</button>

              <!-- sabhi doctors ko dikhao -->
               <div class="showAllDoctors">
                      
               </div>
               
               <div class="specialized_container">
                         <form class="specialized_form">
                            <label for="specialization">Specialization</label>
                            <select name="Specialization" id="specialization">
                                <option value="">--Select--</option>
                                <option value="General Physician">General Physician</option>
                                <option value="Cardiologist">Cardiologist</option>
                                <option value="Neurologist">Neurologist</option>
                                <option value="Dermatologist">Dermatologist</option>
                                <option value="Pediatrician">Pediatrician</option>
                                <option value="Gynecologist">Gynecologist</option>
                                <option value="Orthopedic">Orthopedic</option>
                                <option value="Dentist">Dentist</option>
                                <option value="Psychiatrist">Psychiatrist</option>
                                <option value="ENT Specialist">ENT Specialist</option>
                              
                            </select>
                               <button id="submit-btn">Submit</button>
                        </form>
               </div>

               <div class="specialized_main">
                          
               </div>
       

               <div class="appointment_container">

                  <form id="appointment_form">
                         <label for="appointment_date">Appointment Date</label>
                        <input type="date" id="appointment_date">
                        <button id="appointment_btn">Book</button>
                        </form>
               </div>


    </div>
    <script>
            document.addEventListener("DOMContentLoaded",async()=>{
                   
                let speacializedBtn = document.querySelector(".speacialized-btn");
                let showAllDoctors = document.querySelector(".showAllDoctors");
                let specializedContainer = document.querySelector(".specialized_container");
                let specializedForm = document.querySelector(".specialized_form");
                let specializedMain = document.querySelector(".specialized_main");
                  let appointmentContainer = document.querySelector(".appointment_container");
                  let appointmentForm = document.querySelector("#appointment_form");
                 specializedContainer.classList.add("active");
                 specializedMain.classList.add("active");
                 appointmentContainer.classList.add("active");



                  
                  
               

                  const token = window.localStorage.getItem("token"); 
                async function AllDoctor(){
                          try{
                    let response = await fetch("http://localhost:4000/api/v1/getAll",{
                        method:"GET",
                        headers:{
                            "Authorization":`Bearer ${token}`,
                            "Content-Type":"application/json"
                        },
                        
                    });

                    let result =await response.json();

                        if(result.success){
                            
                           getAllDoctors=[...result.Doctors];
                          
                        }else{
                            alert(result.message);
                        }
                    }catch(err){
                        console.error(err);
                    }

                }    

                      await  AllDoctor();



                        let ShowAll = document.querySelector(".showAllDoctors");

                    getAllDoctors.forEach((doctor)=>{
                        
                       
                       
                        let head = document.createElement("p");
                            head.innerHTML =`${doctor?.name}`
                              ShowAll.appendChild(head);
                    });
                       

                    

                 speacializedBtn.addEventListener("click",(e)=>{
                     e.preventDefault();

                       //all doctor wala form hide krna hai aur specialization wala show krna hai
                       document.querySelector(".specialized_container").classList.remove("active");
                       document.querySelector(".speacialized-btn").classList.add("active");
                        document.querySelector(".showAllDoctors").classList.add("active");
                        document.querySelector(".specialized_main").classList.add("active");
                       
                        
                 });


                   let storeSpecializedDoctors = {};

                  async function getsepecializedDoctor(data){
                       try{
                            let token = window.localStorage.getItem("token");
                             let response =await fetch("http://localhost:4000/api/v1/get_specialization",{
                                method:"POST",
                                headers:{
                                    "Content-Type":"application/json",
                                    "Authorization":`Bearer ${token}`
                                },
                               body:JSON.stringify(data)
                             });

                             let result = await response.json();

                             if(result.success){
                                alert(result.message);
                                  storeSpecializedDoctors={...result};
                                   showDoctor(storeSpecializedDoctors);
                                   document.querySelector(".specialized_container").classList.add("active");
                                   document.querySelector(".specialized_main").classList.remove("active");
                             }else{
                                alert(result.message);
                                
                             }

                       }catch(err){
                               console.error(err);
                       }
               }

                            

                  specializedForm.addEventListener("submit",(e)=>{
                    e.preventDefault();

                    let specialization = document.getElementById("specialization").value;
                        
                    let data ={specialization}
                          getsepecializedDoctor(data);
                });





               
               let docId ="";
              function showDoctor(storeSpecializedDoctors){
                 
                let parentElement = document.querySelector(".specialized_main");
                        parentElement.innerHTML="";
                        console.log( storeSpecializedDoctors.doctor)
                storeSpecializedDoctors.doctor.forEach((doctor)=>{
                   //ek card me ek doctor show ho 
                      
                   let card = document.createElement("div");
                    card.classList.add("doctor_card");
                    let docName = document.createElement("div");
                    let specializedIn = document.createElement("p");
                    let newElement = document.createElement("div");
                    let startTime = document.createElement("div");
                    let endTime = document.createElement("div");
                    let bookBtn = document.createElement("button");

                      docName.setAttribute("id","doctor_name");
                     specializedIn .setAttribute("id","specialized_in");
                     newElement.setAttribute("id","available_days");
                     startTime.setAttribute("id","start_time");
                     endTime.setAttribute("id","end_time");
                     bookBtn.setAttribute("id","book_btn");
                      docName.innerHTML =doctor?.doctorId?.name;
                      specializedIn.innerHTML= doctor?.specialization;
                     newElement.innerHTML = doctor?.available?.days;
                     startTime.innerHTML = doctor?.available?.start ;
                     endTime.innerHTML = doctor?.available?.end;
                     bookBtn.setAttribute("doctor_Id",doctor?._id);
                     bookBtn.innerHTML="Book-Apointment";
                     

                     
                      card.appendChild(docName);
                      card.appendChild(specializedIn);
                      card.appendChild(newElement);
                      card.appendChild(startTime);
                      card.appendChild(endTime);
                       card.appendChild(bookBtn);
                      parentElement.appendChild(card);
                      bookBtn.addEventListener("click",(e)=>{
                           e.preventDefault();
                             docId = bookBtn.getAttribute("doctor_Id");
                       
                         document.querySelector(".appointment_container").classList.remove("active");
                         specializedMain.classList.add("active");
                     })
                })
       
                };






                //complete appointment booking


                async function bookAppointment(data,docId){


                    let response = await fetch(`http://localhost:4000/api/v1/book-appointment/${docId}`,{
                        method:"POST",
                        headers:{
                            "Content-Type":"application/json",
                            "Authorization":`Bearer ${token}`
                        },
                        body:JSON.stringify(data)
                    })

                    let result = await response.json();
                    console.log(result);
                   if(result.success){
                       alert(result.message);

                       
                   }else{
                    alert(result.message);
                   }
                }

              appointmentForm.addEventListener("submit",(e)=>{
                e.preventDefault();
                       let appointmentDate =   document.getElementById("appointment_date").value;
                            
                       let data ={appointmentDate};
                             
                      bookAppointment(data,docId);
              })
                

             
            })
    </script>
    </body>
   
           
 
</html>